<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>My Journal üéôÔ∏èüìì</title>

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

body {
  margin: 0;
  background: radial-gradient(circle at center, #1b0f2a, #06040d);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  color: #e6dfff;
  overflow-x: hidden;
}

/* Background Canvas */

#bgCanvas {
  position: fixed;
  inset: 0;
  z-index: -1;
}

/* App Card */

.app {
  width: 420px;
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(14px);
  border-radius: 22px;
  padding: 16px;
  box-shadow: 0 0 40px rgba(170,120,255,0.2);
  border: 1px solid rgba(200,150,255,0.2);
}

h2 {
  text-align: center;
  color: #d9b3ff;
  margin-bottom: 4px;
}

.subtitle {
  text-align: center;
  font-size: 13px;
  color: #bbb;
  margin-bottom: 10px;
}

.input-row {
  display: flex;
  gap: 8px;
  margin-bottom: 6px;
}

textarea {
  flex: 1;
  min-height: 70px;
  padding: 10px;
  border-radius: 14px;
  border: 1px solid rgba(200,150,255,0.3);
  background: rgba(0,0,0,0.2);
  color: #eee;
  resize: none;
  outline: none;
}

.mic-btn {
  background: #7c4dff;
  color: white;
  border: none;
  border-radius: 50%;
  width: 44px;
  height: 44px;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 0 15px rgba(160,100,255,0.6);
}

.mic-btn.listening {
  background: #4caf50;
  animation: pulse 1s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(76,175,80,0.6); }
  70% { box-shadow: 0 0 0 12px rgba(76,175,80,0); }
  100% { box-shadow: 0 0 0 0 rgba(76,175,80,0); }
}

.status {
  text-align: center;
  font-size: 12px;
  color: #bbb;
  min-height: 16px;
}

.preview {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.box {
  flex: 1;
  background: rgba(255,255,255,0.08);
  border-radius: 14px;
  padding: 8px;
  font-size: 13px;
  min-height: 60px;
}

.box h4 {
  margin: 0 0 4px;
  font-size: 11px;
  color: #d9b3ff;
}

.save-btn {
  width: 100%;
  background: linear-gradient(135deg, #7c4dff, #c084fc);
  color: white;
  border: none;
  border-radius: 14px;
  padding: 10px;
  margin-top: 10px;
  cursor: pointer;
  font-size: 14px;
  box-shadow: 0 0 15px rgba(160,100,255,0.5);
}

.entries {
  margin-top: 12px;
  max-height: 220px;
  overflow-y: auto;
}

.entry {
  background: rgba(255,255,255,0.08);
  border-radius: 14px;
  padding: 10px;
  margin-bottom: 8px;
  font-size: 13px;
}

.entry-date {
  font-size: 11px;
  color: #c084fc;
  font-weight: bold;
  margin-bottom: 4px;
}
</style>
</head>

<body>

<canvas id="bgCanvas"></canvas>

<div class="app">
  <h2>üìì My Journal</h2>
  <div class="subtitle">Type or talk ‚Äî both work üí¨üéôÔ∏è</div>

  <div class="input-row">
    <textarea id="journalInput" placeholder="Write what's on your mind..."></textarea>
    <button class="mic-btn" id="micBtn">üé§</button>
  </div>

  <div class="status" id="status"></div>

  <div class="preview">
    <div class="box">
      <h4>üéôÔ∏è Spoken</h4>
      <div id="spokenText"></div>
    </div>
    <div class="box">
      <h4>‚å®Ô∏è Typed</h4>
      <div id="typedText"></div>
    </div>
  </div>

  <button class="save-btn" onclick="saveEntry()">Save Entry</button>

  <div class="entries" id="entries"></div>
</div>

<script>

/* ---------- Background Animation ---------- */

const canvas = document.getElementById("bgCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

class Particle {
  constructor() {
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height;
    this.vx = Math.random()-0.5;
    this.vy = Math.random()-0.5;
  }
  move() {
    this.x += this.vx;
    this.y += this.vy;
    if(this.x<0||this.x>canvas.width) this.vx*=-1;
    if(this.y<0||this.y>canvas.height) this.vy*=-1;
  }
  draw() {
    ctx.beginPath();
    ctx.arc(this.x,this.y,2,0,Math.PI*2);
    ctx.fillStyle="#c084fc";
    ctx.shadowBlur=15;
    ctx.shadowColor="#c084fc";
    ctx.fill();
  }
}

const particles = Array.from({length:120},()=>new Particle());

function connectParticles(){
  for(let i=0;i<particles.length;i++){
    for(let j=i;j<particles.length;j++){
      const dx=particles[i].x-particles[j].x;
      const dy=particles[i].y-particles[j].y;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<120){
        ctx.beginPath();
        ctx.strokeStyle="rgba(200,150,255,0.2)";
        ctx.moveTo(particles[i].x,particles[i].y);
        ctx.lineTo(particles[j].x,particles[j].y);
        ctx.stroke();
      }
    }
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>{p.move();p.draw();});
  connectParticles();
  requestAnimationFrame(animate);
}
animate();

/* ---------- Journal Logic ---------- */

const journalInput = document.getElementById("journalInput");
const micBtn = document.getElementById("micBtn");
const status = document.getElementById("status");
const spokenBox = document.getElementById("spokenText");
const typedBox = document.getElementById("typedText");
const entriesDiv = document.getElementById("entries");

let entries = JSON.parse(localStorage.getItem("voiceJournal")) || [];

journalInput.addEventListener("input", () => {
  typedBox.innerText = journalInput.value;
});

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

if (!SpeechRecognition) {
  status.innerText = "‚ùå Voice not supported on this browser.";
  micBtn.disabled = true;
} else {
  const recognition = new SpeechRecognition();
  recognition.lang = "en-IN";
  recognition.interimResults = true;

  let listening = false;

  micBtn.onclick = () => {
    if (!listening) recognition.start();
  };

  recognition.onstart = () => {
    listening = true;
    micBtn.classList.add("listening");
    status.innerText = "üéôÔ∏è Listening...";
    spokenBox.innerText = "";
  };

  recognition.onresult = (e) => {
    let transcript = "";
    for (let i = e.resultIndex; i < e.results.length; i++) {
      transcript += e.results[i][0].transcript;
    }
    spokenBox.innerText = transcript;
    journalInput.value = transcript;
    typedBox.innerText = transcript;
  };

  recognition.onend = () => {
    listening = false;
    micBtn.classList.remove("listening");
    status.innerText = "‚úÖ You can save now";
  };
}

function saveEntry() {
  const text = journalInput.value.trim();
  if (!text) return;

  const entry = { text, date: new Date().toLocaleString() };
  entries.unshift(entry);
  localStorage.setItem("voiceJournal", JSON.stringify(entries));

  journalInput.value = "";
  spokenBox.innerText = "";
  typedBox.innerText = "";
  status.innerText = "üíæ Entry saved!";
  renderEntries();
}

function renderEntries() {
  entriesDiv.innerHTML = "";
  entries.forEach(e => {
    const div = document.createElement("div");
    div.className = "entry";
    div.innerHTML = `
      <div class="entry-date">${e.date}</div>
      <div>${e.text}</div>
    `;
    entriesDiv.appendChild(div);
  });
}

renderEntries();

</script>

</body>
</html>
