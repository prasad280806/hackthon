<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>My Journal üéôÔ∏èüìì</title>
<style>
  * { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }

  body {
    background: linear-gradient(135deg, #ffe4ef, #ffd6e8);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .app {
    width: 420px;
    background: #fff0f6;
    border-radius: 22px;
    padding: 16px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  }

  h2 {
    text-align: center;
    color: #ff4d88;
    margin-bottom: 4px;
  }

  .subtitle {
    text-align: center;
    font-size: 13px;
    color: #777;
    margin-bottom: 10px;
  }

  .input-row {
    display: flex;
    gap: 8px;
    margin-bottom: 6px;
  }

  textarea {
    flex: 1;
    min-height: 70px;
    padding: 10px;
    border-radius: 14px;
    border: 1px solid #ccc;
    resize: none;
    outline: none;
  }

  .mic-btn {
    background: #ff4d88;
    color: white;
    border: none;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    font-size: 18px;
    cursor: pointer;
  }

  .mic-btn.listening {
    background: #4caf50;
    animation: pulse 1s infinite;
  }

  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(76,175,80,0.6); }
    70% { box-shadow: 0 0 0 12px rgba(76,175,80,0); }
    100% { box-shadow: 0 0 0 0 rgba(76,175,80,0); }
  }

  .status {
    text-align: center;
    font-size: 12px;
    color: #666;
    min-height: 16px;
  }

  .preview {
    display: flex;
    gap: 8px;
    margin-top: 8px;
  }

  .box {
    flex: 1;
    background: white;
    border-radius: 14px;
    padding: 8px;
    font-size: 13px;
    min-height: 60px;
  }

  .box h4 {
    margin: 0 0 4px;
    font-size: 11px;
    color: #ff4d88;
  }

  .save-btn {
    width: 100%;
    background: #ff4d88;
    color: white;
    border: none;
    border-radius: 14px;
    padding: 10px;
    margin-top: 10px;
    cursor: pointer;
    font-size: 14px;
  }

  .entries {
    margin-top: 12px;
    max-height: 220px;
    overflow-y: auto;
  }

  .entry {
    background: white;
    border-radius: 14px;
    padding: 10px;
    margin-bottom: 8px;
    font-size: 13px;
  }

  .entry-date {
    font-size: 11px;
    color: #ff4d88;
    font-weight: bold;
    margin-bottom: 4px;
  }
</style>
</head>
<body>

<div class="app">
  <h2>üìì My Journal</h2>
  <div class="subtitle">Type or talk ‚Äî both work üí¨üéôÔ∏è</div>

  <div class="input-row">
    <textarea id="journalInput" placeholder="Write what's on your mind..."></textarea>
    <button class="mic-btn" id="micBtn">üé§</button>
  </div>

  <div class="status" id="status"></div>

  <div class="preview">
    <div class="box">
      <h4>üéôÔ∏è Spoken</h4>
      <div id="spokenText"></div>
    </div>
    <div class="box">
      <h4>‚å®Ô∏è Typed</h4>
      <div id="typedText"></div>
    </div>
  </div>

  <button class="save-btn" onclick="saveEntry()">Save Entry</button>

  <div class="entries" id="entries"></div>
</div>

<script>
const journalInput = document.getElementById("journalInput");
const micBtn = document.getElementById("micBtn");
const status = document.getElementById("status");
const spokenBox = document.getElementById("spokenText");
const typedBox = document.getElementById("typedText");
const entriesDiv = document.getElementById("entries");

let entries = JSON.parse(localStorage.getItem("voiceJournal")) || [];

/* ----------- Typed Preview ----------- */
journalInput.addEventListener("input", () => {
  typedBox.innerText = journalInput.value;
});

/* ----------- Speech Recognition ----------- */
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

if (!SpeechRecognition) {
  status.innerText = "‚ùå Voice not supported on this browser.";
  micBtn.disabled = true;
} else {
  const recognition = new SpeechRecognition();
  recognition.lang = "en-IN";
  recognition.continuous = false;
  recognition.interimResults = true;

  micBtn.onclick = () => recognition.start();

  recognition.onstart = () => {
    micBtn.classList.add("listening");
    status.innerText = "üéôÔ∏è Listening...";
    spokenBox.innerText = "";
  };

  recognition.onresult = (event) => {
    let transcript = "";
    for (let i = event.resultIndex; i < event.results.length; i++) {
      transcript += event.results[i][0].transcript;
    }
    spokenBox.innerText = transcript;
    journalInput.value = transcript;
    typedBox.innerText = transcript;
  };

  recognition.onend = () => {
    micBtn.classList.remove("listening");
    status.innerText = "‚úÖ You can save now";
  };

  recognition.onerror = () => {
    status.innerText = "‚ö†Ô∏è Couldn't hear you. Try again.";
  };
}

/* ----------- Journal Logic ----------- */
function saveEntry() {
  const text = journalInput.value.trim();
  if (!text) return;

  const entry = {
    text,
    date: new Date().toLocaleString()
  };

  entries.unshift(entry);
  localStorage.setItem("voiceJournal", JSON.stringify(entries));

  journalInput.value = "";
  spokenBox.innerText = "";
  typedBox.innerText = "";
  status.innerText = "üíæ Entry saved!";
  renderEntries();
}

function renderEntries() {
  entriesDiv.innerHTML = "";
  entries.forEach(e => {
    const div = document.createElement("div");
    div.className = "entry";
    div.innerHTML = `
      <div class="entry-date">${e.date}</div>
      <div>${e.text}</div>
    `;
    entriesDiv.appendChild(div);
  });
}

renderEntries();
</script>

</body>
</html>